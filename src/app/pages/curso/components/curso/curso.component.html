<div class="container-fluid">
  <div class="row">
    <div class="col-md-6 py-4" *ngIf="curso">
      <div *ngIf="!curso">
        <mat-spinner></mat-spinner>
      </div>
      <!--Esta columna incluye:
              * El video de la clase que se seleccione para su reproduccion
              * Recursos (PDFs, Presentaciones y/o doumentos)
              * Foro de comentarios por clase
          -->
      <mat-card class="example-card">
        <!-- Este card contiene:
                * Video de la clase, el titulo y descripcion del curso.
                * Recursos por clase
              -->
        <!-- Este es el video de la clase con una imagen (poster) del curso-->
        <video src="{{ rutaVideo }}" poster="{{ curso.imagen_curso }}" controls muted controlslist="nodownload"
          autoplay></video>
        <!--Titulo y Descripcion de Curso-->
        <mat-card-header>
          <mat-card-title class="py-3">
            {{ curso.nombre_curso }}
          </mat-card-title>
          <mat-card-subtitle>
            Descripción del Curso: {{ curso.descripcion_curso }}
          </mat-card-subtitle>
        </mat-card-header>
        <!--Fin: Titulo y Descripcion de Curso-->
        <mat-card-content>

          <div *ngIf="recursos">
            <hr>
            <h4>Recursos de la clase</h4>
            <div *ngIf="recursos.length == 0">
              <div class="alert alert-danger col-12">
                <p class="mensaje">No existen recursos de esta clase</p>
              </div>
            </div>
            <div *ngFor="let recurso of recursos">
              <a align="end" mat-icon-button color="primary" matTooltip="descargar recurso" target=”_blank”
                href="{{recurso.link_recurso}}">
                <mat-icon>get_app</mat-icon>
                {{recurso.nombre_recurso}}
              </a>
            </div>
          </div>

          <!--Inicio de la seccion del foro de comentarios-->
          <!--Comentarios-->
          <mat-selection-list *ngIf="dat" [multiple]="false">
            <div *ngIf="foro">
              <mat-list-item *ngFor=" let item of dat" class="row">
                <mat-icon mat-list-icon>person</mat-icon>
                <div mat-line>
                  <div mat-line>{{ item.usuario_comentario.nombre_usuario }}</div>
                  <div mat-line>{{ item.texto_comentario }}</div>
                  <div mat-line>
                    <button mat-button color="warn" (click)="openRespuestas(item.id_comentario);">Responder</button>
                  </div>
                </div>
                <div mat-line>
                  <div *ngIf="item.comentario_respuesta.length || 0">
                    <mat-accordion>
                      <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                        <mat-expansion-panel-header>
                          <mat-panel-title>
                            Ver {{item.comentario_respuesta.length}} respuestas
                          </mat-panel-title>
                        </mat-expansion-panel-header>
                        <mat-list-option *ngFor="let res of item.comentario_respuesta; let i = index">
                          <div mat-line>
                            <div mat-line>
                              <mat-icon mat-list-icon>person</mat-icon>
                              Respuesta: {{ res.texto_respuesta }}
                            </div>
                          </div>
                        </mat-list-option>
                      </mat-expansion-panel>
                    </mat-accordion>
                  </div>
                </div>
              </mat-list-item>
            </div>
          </mat-selection-list>
          <!--Comentario del estudiante o docente-->
        </mat-card-content>
      </mat-card>
      <!--Final del Card-->
      <br>
    </div>
    <!--Final de la columna-->
    <div class="col-md-6 py-4">
      <!--
            En esta columna se muestra:
              * Secciones del Curso
              * Clases del Curso
              * Un boton para mostrar los recurso
            -->
      <!--Progress bar de progreso-->
      <div class="card">
        <div class="card-body">
          <h4 class="card-title">Tu progreso</h4>
          <p class="card-text">
            <mat-progress-bar mode="determinate" [value]="count">Tu progreso</mat-progress-bar>
          </p>
          <a *ngIf="certificadoBoton" href="{{API_BACKEND + certificado}}" target="_blank"> Ver
            certificado</a>
        </div>
      </div>
      <!--Fin Progress bar de progreso-->
      <mat-accordion multi *ngFor="let modulo of modulos; let i = index">
        <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
          <mat-expansion-panel-header>
            Sección {{ i + 1 }}: &nbsp;{{ modulo.nombre_modulo }}
          </mat-expansion-panel-header>
          <!--Contenido de la clase-->
          <mat-selection-list #shoes [multiple]="false">
            <mat-list-item *ngFor="let clases of modulo.clases_modulo; let i = index; let prog = pro">
              <div mat-line>
                <div mat-line>
                  <!--clases.id_clase-->
                  <button mat-icon-button color="primary" type="button"
                    (click)="setVideo(clases.video_clase, clases.id_clase)" matTooltip="Reproducir video">
                    <mat-icon>play_circle_filled</mat-icon>
                  </button>Capítulo {{ i + 1 }}: {{ clases.titulo_clase }}
                </div>
                <div mat-line>
                  <button mat-icon-button color="primary" matTooltip="Descripcion de la clase" color="accent">
                    <mat-icon>description</mat-icon>
                  </button>
                  Descripcion de la clase: {{ clases.descripcion_clase }}
                </div>
                <!--Nueva seccion para los recursos-->
              </div>
              <div mat-line align="end">
                <button mat-icon-button color="basic" type="button" (click)="getClase(clases.id_clase)"
                  matTooltip="Mostrar recursos de la clase">
                  <mat-icon>assignment</mat-icon>
                </button>
                <button mat-icon-button color="primary" type="button" (click)="getIdClase(clases.id_clase)"
                  matTooltip="Mostrar el foro de la clase">
                  <mat-icon>forum</mat-icon>
                </button>
                <button mat-icon-button color="warn" type="button" (click)="openDialog(clases.id_clase)"
                  matTooltip="Agrega un comentario de la clase">
                  <mat-icon>insert_comment</mat-icon>
                </button>
              </div>
            </mat-list-item>
            <div>
              <mat-checkbox class="example-margin" matTooltip="Sección terminada!" [(ngModel)]="progreso[i].estado"
                (change)="cambios(i, !progreso[i].estado)">Seccion completada</mat-checkbox>
            </div>
          </mat-selection-list>
        </mat-expansion-panel>
        <br />
      </mat-accordion>
      <!--Capitulos del Curso-->
    </div>
    <!--Final de la columna-->
  </div>
</div>
